,controversiality,parent_id,body,subreddit,id,score,subreddit_id
5371434,0,t1_cvy7zde,Yeah so that worked but its returning it into an output of like hundreds of little windows. So I had amended my original script to create a temp table and put everything into the temp table. So Id have it in one clean output. I also forgot that I needed to run an inner join in the scriptrequirements changed from userSo the following is what I just trailored from yours that was working but showing hundreds of little windows. I can see it is definitly running against every single DB. Unfortunately at a point the output stops and it returns an error invalid object name dbo.NLTRAN and what it was outputting is gone.If there is a way to put the below you provided into like a temp table that would be perfect. As it would be in one output window that I could copy to Excel     EXECUTE master.sys.spMSforeachdb USE ? SELECT dbnameNLTRAN.RefrNLTRAN.CCCodeNLTRAN.UserNameNLBatch.UserNameNLTRAN.NomCodeNLTRAN.DetailsNLTRAN.RefrNLTRAN.TrxTypeNLTRAN.SourceNLTRAN.DeptCodeNLTRAN.FValueNLTRAN.HValueNLTRAN.XRateNLTRAN.JournalTypeNLTRAN.YearNoNLTRAN.Period from dbo.NLTRAN INNER JOIN dbo.NLBatch ON NLTRAN.BatchNLBatch.BatchNo where NLTRAN.UserName ltgtESB AND NLTRAN.YearNo  AND NLTRAN.Period  AND NLTRAN.TrxType JL AND NLTRAN.Source NL ORDER by NLTRAN.CCCode Here is what I was using and working with this afternoon although I dont think it was properly running against every DB    create table Elizabeth Database VARCHARRefr VARCHARCCCode VARCHARUserName Created VARCHARUserName Posted VARCHARNomCode VARCHARDetails VARCHAR Refr VARCHARTrxType VARCHARSource VARCHARDeptCode VARCHARFVALUE VARCHARHValue VARCHARXRate VARCHARJournalType VARCHARYearNo VARCHARPeriod VARCHAR    DECLARE command varchar    SELECT command  INSERT INTO Elizabeth    SELECT dbnameNLTRAN.RefrNLTRAN.CCCodeNLTRAN.UserNameNLBatch.UserNameNLTRAN.NomCodeNLTRAN.DetailsNLTRAN.RefrNLTRAN.TrxTypeNLTRAN.SourceNLTRAN.DeptCodeNLTRAN.FValueNLTRAN.HValueNLTRAN.XRateNLTRAN.JournalTypeNLTRAN.YearNoNLTRAN.Period    from dbo.NLTRAN    INNER JOIN dbo.NLBatch    ON NLTRAN.BatchNLBatch.BatchNo    where NLTRAN.UserName ltgtESB    AND NLTRAN.YearNo     AND NLTRAN.Period     AND NLTRAN.TrxType JL    AND NLTRAN.Source NL    ORDER by NLTRAN.CCCode    exec spMSforeachdb command    select  from Elizabeth    drop table ElizabethThe output of the above is literally perfect. Im just not convinced it is running against every Db on the server. The dbname field would suggest it is not ,MSSQL,cvy9erq,1,t5_2w5wq
9023991,0,t1_d7wbq6a,Thank you kindly for the response uasdubya!So Ive changed out CROSS APPLY for CROSS JOIN and it resulted in the same outcome. However after looking at Technet regarding the subject I see that the use of the WHERE clause in this statement makes it act like an INNER JOIN....What would I need to do in order to filter this out? I suppose I may need to insert the result set into a temp table or something and then break it down?,MSSQL,d7wjjbt,1,t5_2w5wq
