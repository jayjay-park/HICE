,controversiality,parent_id,body,subreddit,id,score,subreddit_id
4856339,0,t3_3he60l,Heres a Macro that utilizes collections! What a coincidence that I made it today!           iRchickenz           FolderSubfolder Dig adapted from                Print Directory Tree to Excel           oFSO oFolder oSubfolder and oFile are not Dim  As so       you dont have to reference Microsoft Runtime Script. If dimmed as       FileSystemObject Folder Folder and File respectively MRS must be       referenced in ToolsgtReferences...           Because usedrange is used add a title anywhere in row  to       prevent any issues. There are other ways around this issue.            Public Sub DirTree    Dim myPath As String myPath  cpath     I use a range here and add a button linked to this Macro for easy copypasteclick.    Dim oFSO oFolder oSubfolder oFile oItem As Collection Set oItem  New Collection    Dim oCount As Integer iCount As Integer iCount  LenmyPath  LenReplacemyPath     iCount is the number of  in parent path.        Set oFSO  CreateObjectScripting.FileSystemObject    oItem.Add oFSO.GetFoldermyPath     Parent path added to collection        Do While oItem.Count gt     Set oFolder  oItemoItem.Count     Move to end of collection. Adding new items to the end of the collection allows for correct tree looping    oItem.Remove oItem.Count   Remove from collection        oCount  LenoFolder  LenReplaceoFolder    iCount    oCount sets column number    Sheets.CellsSheets.UsedRange.Rows.Count   oCount  oFolder    Place path name in correct column and next available row            For Each oSubfolder In oFolder.SubFolders        oItem.Add oSubfolder     Add subfolders to collection        Next oSubfolder            For Each oFile In oFolder.Files        oCount  LenoFile  LenReplaceoFile    iCount  Set column number to same as its parent folder        Sheets.CellsSheets.UsedRange.Rows.Count   oCount  oFile  Place underneath        Next oFile    Loop    End Sub               Add Error Handling for a more robust Macro.       Add a highlight to cells that contain folders for ease of use.    ,learnexcel,cu6of8q,2,t5_2zfk7
